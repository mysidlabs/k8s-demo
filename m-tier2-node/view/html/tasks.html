<!DOCTYPE html>
<html lang="en">

  <% var action = 'tasks' %>
  <% include includes/header.html %>
  
  <body class="fixed-sn white-skin">
  
  <% include includes/menu.html %>

  <main class="mx-0 pl-0">
    <div class="container-fluid">

      <!-- First row -->
      <div class="row pt-1 pb-3 mx-2">
        <div class="col-md-3 mb-4">
          <div class="card-body pt-0">

          <button type="button" accesskey="T" class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#modal-create" onclick="setTimeout(function(){$('#taskName').focus()},1000)" >
              <i class="fas fa-plus left"></i> New Task
          </button>
          </div>
        </div>
        <div class="col-md-9 white z-depth-1 mb-2">
          <div class="row">
            <div class="col-md-12 py-3">
                <div class="table-responsive mt-2">
                  <table class="table table-striped table-bordered">
                    <thead>
                      <tr>
                          <th colspan="8" class="blue lighten-1 white-text text-center">CURRENT TASKS</th>
                      </tr>
                      <tr>
                        <th></th>
                        <th class="text-center" scope="row">Task Name</th>
                        <th class="text-center">Duration</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% 
                        tasks.forEach(function(task){ 
                      %>
                      <tr>
                        <th scope="row" class="text-center text-nowrap">
                          <button class="fas fa-trash p-2" data-toggle="modal" data-target="#modal-delete" onclick="$('#del-name').text('<%= task.name %>');selectedId = '<%=task._id%>';"></button>
                          <button class="fas fa-edit p-2" data-toggle="modal" data-target="#modal-create" onclick="loadForm('taskForm','/tasks','<%=task._id%>');"></button>
                        </th>
                        <td><%= task.name %></td>
                        <td><%= task.duration %></td>
                      </tr>
                      <% }) %>
                      <%
                        if(tasks.length == 0) {
                      %>
                            <tr>
                                <td colspan="3" class="text-center">
                                    <i class="fa fa-exclamation-triangle red-text"></i> No Tasks Exist In Database
                                </td>
                            </tr>
                      <%
                        }
                      %>
                    </tbody>
                  </table>
                </div>
            </div>
          </div>
        </div>
      </div>
      
  </main>
  <!--Main layout-->

  <% include includes/footer.html %>
  <% include includes/delete-modal.html %>  
  <% include includes/scripts.html %>


  <div class="modal fade" id="modal-create" tabindex="-1" role="dialog" aria-labelledby="createCenterModal" aria-hidden="true">

    <div class="modal-dialog modal-dialog-centered" role="document">

      <div class="modal-content">
        <form id="taskForm" method="POST">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">Task</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <input name="name" id="taskName" class="form-control" value="" placeholder="Enter Task Name" />
            </div>
            <div class="form-group">
              <input name="duration" class="form-control" value="" placeholder="Enter Task Duration" onchange="saveForm(this,'/tasks',true)" />
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" onclick="saveForm(this,'/tasks',true)">Save</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>

</html>
